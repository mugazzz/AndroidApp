"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.AndroidDriver = void 0;

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _appiumBaseDriver = require("appium-base-driver");

var _desiredCaps = _interopRequireDefault(require("./desired-caps"));

var _index = _interopRequireDefault(require("./commands/index"));

var _androidHelpers = _interopRequireDefault(require("./android-helpers"));

var _logger = _interopRequireDefault(require("./logger"));

var _lodash = _interopRequireDefault(require("lodash"));

var _appiumAdb = require("appium-adb");

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _sharedPreferencesBuilder = require("shared-preferences-builder");

var _bluebird = _interopRequireDefault(require("bluebird"));

const APP_EXTENSION = '.apk';
const DEVICE_PORT = 4724;
const NO_PROXY = [['POST', new RegExp('^/session/[^/]+/context')], ['GET', new RegExp('^/session/[^/]+/context')], ['POST', new RegExp('^/session/[^/]+/appium')], ['GET', new RegExp('^/session/[^/]+/appium')], ['POST', new RegExp('^/session/[^/]+/touch/perform')], ['POST', new RegExp('^/session/[^/]+/touch/multi/perform')], ['POST', new RegExp('^/session/[^/]+/orientation')], ['GET', new RegExp('^/session/[^/]+/orientation')]];

class AndroidDriver extends _appiumBaseDriver.BaseDriver {
  constructor(opts = {}, shouldValidateCaps = true) {
    super(opts, shouldValidateCaps);
    this.locatorStrategies = ['xpath', 'id', 'class name', 'accessibility id', '-android uiautomator'];
    this.desiredCapConstraints = _desiredCaps.default;
    this.sessionChromedrivers = {};
    this.jwpProxyActive = false;
    this.jwpProxyAvoid = _lodash.default.clone(NO_PROXY);
    this.settings = new _appiumBaseDriver.DeviceSettings({
      ignoreUnimportantViews: false
    }, this.onSettingsUpdate.bind(this));
    this.chromedriver = null;
    this.apkStrings = {};
    this.bootstrapPort = opts.bootstrapPort || DEVICE_PORT;
    this.unlocker = _androidHelpers.default.unlocker;
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
      for (var _iterator = _lodash.default.toPairs(_index.default)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
        let _step$value = (0, _slicedToArray2.default)(_step.value, 2),
            cmd = _step$value[0],
            fn = _step$value[1];

        AndroidDriver.prototype[cmd] = fn;
      }
    } catch (err) {
      _didIteratorError = true;
      _iteratorError = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion && _iterator.return != null) {
          _iterator.return();
        }
      } finally {
        if (_didIteratorError) {
          throw _iteratorError;
        }
      }
    }
  }

  createSession(...args) {
    var _this = this,
        _superprop_callCreateSession = (..._args) => super.createSession(..._args);

    return (0, _asyncToGenerator2.default)(function* () {
      try {
        let _ref = yield _superprop_callCreateSession(...args),
            _ref2 = (0, _slicedToArray2.default)(_ref, 2),
            sessionId = _ref2[0],
            caps = _ref2[1];

        let serverDetails = {
          platform: 'LINUX',
          webStorageEnabled: false,
          takesScreenshot: true,
          javascriptEnabled: true,
          databaseEnabled: false,
          networkConnectionEnabled: true,
          locationContextEnabled: false,
          warnings: {},
          desired: _this.caps
        };
        _this.caps = Object.assign(serverDetails, _this.caps);
        let defaultOpts = {
          action: "android.intent.action.MAIN",
          category: "android.intent.category.LAUNCHER",
          flags: "0x10200000",
          disableAndroidWatchers: false,
          tmpDir: yield _appiumSupport.tempDir.staticDir(),
          fullReset: false,
          autoLaunch: true,
          adbPort: _appiumAdb.DEFAULT_ADB_PORT,
          androidInstallTimeout: 90000
        };

        _lodash.default.defaults(_this.opts, defaultOpts);

        if (!_this.opts.javaVersion) {
          _this.opts.javaVersion = yield _androidHelpers.default.getJavaVersion();
        }

        _this.useUnlockHelperApp = _lodash.default.isUndefined(_this.caps.unlockType);

        if (_this.opts.noReset === true) {
          _this.opts.fullReset = false;
        }

        if (_this.opts.fullReset === true) {
          _this.opts.noReset = false;
        }

        _this.opts.fastReset = !_this.opts.fullReset && !_this.opts.noReset;
        _this.opts.skipUninstall = _this.opts.fastReset || _this.opts.noReset;
        _this.curContext = _this.defaultContextName();

        if (_this.isChromeSession) {
          _logger.default.info("We're going to run a Chrome-based session");

          let _helpers$getChromePkg = _androidHelpers.default.getChromePkg(_this.opts.browserName),
              pkg = _helpers$getChromePkg.pkg,
              activity = _helpers$getChromePkg.activity;

          _this.opts.appPackage = pkg;
          _this.opts.appActivity = activity;

          _logger.default.info(`Chrome-type package and activity are ${pkg} and ${activity}`);
        }

        if (_this.opts.nativeWebScreenshot) {
          _this.jwpProxyAvoid.push(['GET', new RegExp('^/session/[^/]+/screenshot')]);
        }

        if (_this.opts.reboot) {
          _this.setAvdFromCapabilities(caps);
        }

        let _ref3 = yield _androidHelpers.default.getDeviceInfoFromCaps(_this.opts),
            udid = _ref3.udid,
            emPort = _ref3.emPort;

        _this.opts.udid = udid;
        _this.opts.emPort = emPort;
        _this.adb = yield _androidHelpers.default.createADB({
          javaVersion: _this.opts.javaVersion,
          udid: _this.opts.udid,
          emPort: _this.opts.emPort,
          adbPort: _this.opts.adbPort,
          suppressKillServer: _this.opts.suppressKillServer,
          remoteAdbHost: _this.opts.remoteAdbHost,
          clearDeviceLogsOnStart: _this.opts.clearDeviceLogsOnStart,
          adbExecTimeout: _this.opts.adbExecTimeout
        });

        if ((yield _this.adb.getApiLevel()) >= 23) {
          _logger.default.warn("Consider setting 'automationName' capability to " + "'uiautomator2' on Android >= 6, since UIAutomator framework " + "is not maintained anymore by the OS vendor.");
        }

        if (_this.helpers.isPackageOrBundle(_this.opts.app)) {
          _this.opts.appPackage = _this.opts.app;
          _this.opts.app = null;
        }

        if (_this.opts.app) {
          _this.opts.app = yield _this.helpers.configureApp(_this.opts.app, APP_EXTENSION);
          _this.opts.appIsTemp = caps.app !== _this.opts.app;
          yield _this.checkAppPresent();
        } else if (_this.appOnDevice) {
          _logger.default.info(`App file was not listed, instead we're going to run ` + `${_this.opts.appPackage} directly on the device`);

          yield _this.checkPackagePresent();
        }

        if (_appiumSupport.util.hasValue(_this.opts.networkSpeed)) {
          if (!_this.isEmulator()) {
            _logger.default.warn("Sorry, networkSpeed capability is only available for emulators");
          } else {
            let networkSpeed = _androidHelpers.default.ensureNetworkSpeed(_this.adb, _this.opts.networkSpeed);

            yield _this.adb.networkSpeed(networkSpeed);
          }
        }

        if (_appiumSupport.util.hasValue(_this.opts.gpsEnabled)) {
          if (_this.isEmulator()) {
            _logger.default.info(`Trying to ${_this.opts.gpsEnabled ? "enable" : "disable"} gps location provider`);

            yield _this.adb.toggleGPSLocationProvider(_this.opts.gpsEnabled);
          } else {
            _logger.default.warn('Sorry! gpsEnabled capability is only available for emulators');
          }
        }

        yield _this.startAndroidSession(_this.opts);
        return [sessionId, _this.caps];
      } catch (e) {
        try {
          yield _this.deleteSession();
        } catch (ign) {}

        throw e;
      }
    })();
  }

  isEmulator() {
    return !!(this.opts.avd || /emulator/.test(this.opts.udid));
  }

  setAvdFromCapabilities(caps) {
    if (this.opts.avd) {
      _logger.default.info('avd name defined, ignoring device name and platform version');
    } else {
      if (!caps.deviceName) {
        _logger.default.errorAndThrow('avd or deviceName should be specified when reboot option is enables');
      }

      if (!caps.platformVersion) {
        _logger.default.errorAndThrow('avd or platformVersion should be specified when reboot option is enabled');
      }

      let avdDevice = caps.deviceName.replace(/[^a-zA-Z0-9_.]/g, "-");
      this.opts.avd = `${avdDevice}__${caps.platformVersion}`;
    }
  }

  get appOnDevice() {
    return this.helpers.isPackageOrBundle(this.opts.app) || !this.opts.app && this.helpers.isPackageOrBundle(this.opts.appPackage);
  }

  get isChromeSession() {
    return _androidHelpers.default.isChromeBrowser(this.opts.browserName);
  }

  onSettingsUpdate(key, value) {
    var _this2 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (key === "ignoreUnimportantViews") {
        yield _this2.setCompressedLayoutHierarchy(value);
      }
    })();
  }

  startAndroidSession() {
    var _this3 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.info(`Starting Android session`);

      _this3.defaultIME = yield _androidHelpers.default.initDevice(_this3.adb, _this3.opts);
      _this3.caps.deviceName = _this3.adb.curDeviceId;
      _this3.caps.deviceUDID = _this3.opts.udid;
      _this3.caps.platformVersion = yield _this3.adb.getPlatformVersion();
      _this3.caps.deviceScreenSize = yield _this3.adb.getScreenSize();
      _this3.caps.deviceModel = yield _this3.adb.getModel();
      _this3.caps.deviceManufacturer = yield _this3.adb.getManufacturer();

      if (_this3.opts.autoLaunch) {
        yield _this3.initAUT();
      }

      if (_this3.opts.disableWindowAnimation) {
        if (yield _this3.adb.isAnimationOn()) {
          if ((yield _this3.adb.getApiLevel()) >= 28) {
            _logger.default.warn('Relaxing hidden api policy to manage animation scale');

            yield _this3.adb.setHiddenApiPolicy('1');
          }

          _logger.default.info('Disabling window animation as it is requested by "disableWindowAnimation" capability');

          yield _this3.adb.setAnimationState(false);
          _this3._wasWindowAnimationDisabled = true;
        } else {
          _logger.default.info('Window animation is already disabled');
        }
      }

      _this3.bootstrap = new _androidHelpers.default.bootstrap(_this3.adb, _this3.bootstrapPort, _this3.opts.websocket);
      yield _this3.bootstrap.start(_this3.opts.appPackage, _this3.opts.disableAndroidWatchers, _this3.opts.acceptSslCerts);

      _this3.bootstrap.onUnexpectedShutdown.catch(function () {
        var _ref4 = (0, _asyncToGenerator2.default)(function* (err) {
          if (!_this3.bootstrap.ignoreUnexpectedShutdown) {
            yield _this3.startUnexpectedShutdown(err);
          }
        });

        return function (_x) {
          return _ref4.apply(this, arguments);
        };
      }());

      if (!_this3.opts.skipUnlock) {
        yield _androidHelpers.default.unlock(_this3, _this3.adb, _this3.caps);
      }

      if (_this3.opts.ignoreUnimportantViews) {
        yield _this3.settings.update({
          ignoreUnimportantViews: _this3.opts.ignoreUnimportantViews
        });
      }

      if (_this3.isChromeSession) {
        yield _this3.startChromeSession();
      } else {
        if (_this3.opts.autoLaunch) {
          yield _this3.startAUT();
        }
      }

      if (_appiumSupport.util.hasValue(_this3.opts.orientation)) {
        _logger.default.debug(`Setting initial orientation to '${_this3.opts.orientation}'`);

        yield _this3.setOrientation(_this3.opts.orientation);
      }

      yield _this3.initAutoWebview();
    })();
  }

  initAutoWebview() {
    var _this4 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (_this4.opts.autoWebview) {
        let viewName = _this4.defaultWebviewName();

        let timeout = _this4.opts.autoWebviewTimeout || 2000;

        _logger.default.info(`Setting auto webview to context '${viewName}' with timeout ${timeout}ms`);

        yield (0, _asyncbox.retryInterval)(timeout / 500, 500, (0, _asyncToGenerator2.default)(function* () {
          yield _this4.setContext(viewName);
        }));
      }
    })();
  }

  initAUT() {
    var _this5 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let launchInfo = yield _androidHelpers.default.getLaunchInfo(_this5.adb, _this5.opts);
      Object.assign(_this5.opts, launchInfo);
      Object.assign(_this5.caps, launchInfo);

      if (_this5.opts.otherApps) {
        let otherApps;

        try {
          otherApps = _androidHelpers.default.parseArray(_this5.opts.otherApps);
        } catch (e) {
          _logger.default.errorAndThrow(`Could not parse "otherApps" capability: ${e.message}`);
        }

        otherApps = yield _bluebird.default.all(otherApps.map(app => _this5.helpers.configureApp(app, APP_EXTENSION)));
        yield _androidHelpers.default.installOtherApks(otherApps, _this5.adb, _this5.opts);
      }

      if (!_this5.opts.app) {
        if (_this5.opts.fullReset) {
          _logger.default.errorAndThrow('Full reset requires an app capability, use fastReset if app is not provided');
        }

        _logger.default.debug('No app capability. Assuming it is already on the device');

        if (_this5.opts.fastReset) {
          yield _androidHelpers.default.resetApp(_this5.adb, _this5.opts);
        }

        return;
      }

      if (!_this5.opts.skipUninstall) {
        yield _this5.adb.uninstallApk(_this5.opts.appPackage);
      }

      yield _androidHelpers.default.installApk(_this5.adb, _this5.opts);
      const apkStringsForLanguage = yield _androidHelpers.default.pushStrings(_this5.opts.language, _this5.adb, _this5.opts);

      if (_this5.opts.language) {
        _this5.apkStrings[_this5.opts.language] = apkStringsForLanguage;
      }

      if (!_lodash.default.isUndefined(_this5.opts.sharedPreferences)) {
        yield _this5.setSharedPreferences(_this5.opts);
      }
    })();
  }

  checkAppPresent() {
    var _this6 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug("Checking whether app is actually present");

      if (!(yield _appiumSupport.fs.exists(_this6.opts.app))) {
        _logger.default.errorAndThrow(`Could not find app apk at ${_this6.opts.app}`);
      }
    })();
  }

  checkPackagePresent() {
    var _this7 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug("Checking whether package is present on the device");

      if (!(yield _this7.adb.shell(['pm', 'list', 'packages', _this7.opts.appPackage]))) {
        _logger.default.errorAndThrow(`Could not find package ${_this7.opts.appPackage} on the device`);
      }
    })();
  }

  setCompressedLayoutHierarchy(compress) {
    var _this8 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield _this8.bootstrap.sendAction("compressedLayoutHierarchy", {
        compressLayout: compress
      });
    })();
  }

  deleteSession() {
    var _this9 = this,
        _superprop_callDeleteSession = (..._args2) => super.deleteSession(..._args2);

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug("Shutting down Android driver");

      yield _androidHelpers.default.removeAllSessionWebSocketHandlers(_this9.server, _this9.sessionId);
      yield _superprop_callDeleteSession();

      if (_this9.bootstrap) {
        yield _this9.stopChromedriverProxies();

        if (_this9.opts.unicodeKeyboard && _this9.opts.resetKeyboard && _this9.defaultIME) {
          _logger.default.debug(`Resetting IME to ${_this9.defaultIME}`);

          yield _this9.adb.setIME(_this9.defaultIME);
        }

        if (!_this9.isChromeSession) {
          yield _this9.adb.forceStop(_this9.opts.appPackage);
        }

        yield _this9.adb.goToHome();

        if (_this9.opts.fullReset && !_this9.opts.skipUninstall && !_this9.appOnDevice) {
          yield _this9.adb.uninstallApk(_this9.opts.appPackage);
        }

        yield _this9.bootstrap.shutdown();
        _this9.bootstrap = null;
      } else {
        _logger.default.debug("Called deleteSession but bootstrap wasn't active");
      }

      yield _this9.adb.stopLogcat();

      if (_this9.useUnlockHelperApp) {
        yield _this9.adb.forceStop('io.appium.unlock');
      }

      if (_this9._wasWindowAnimationDisabled) {
        _logger.default.info('Restoring window animation state');

        yield _this9.adb.setAnimationState(true);

        if ((yield _this9.adb.getApiLevel()) >= 28) {
          _logger.default.info('Restoring hidden api policy to the device default configuration');

          yield _this9.adb.setDefaultHiddenApiPolicy();
        }
      }

      if (_this9.opts.reboot) {
        let avdName = _this9.opts.avd.replace('@', '');

        _logger.default.debug(`closing emulator '${avdName}'`);

        yield _this9.adb.killEmulator(avdName);
      }

      if (_this9.opts.clearSystemFiles) {
        if (_this9.opts.appIsTemp) {
          _logger.default.debug(`Temporary copy of app was made: deleting '${_this9.opts.app}'`);

          try {
            yield _appiumSupport.fs.rimraf(_this9.opts.app);
          } catch (err) {
            _logger.default.warn(`Unable to delete temporary app: ${err.message}`);
          }
        } else {
          _logger.default.debug('App was not copied, so not deleting');
        }
      } else {
        _logger.default.debug('Not cleaning generated files. Add `clearSystemFiles` capability if wanted.');
      }
    })();
  }

  setSharedPreferences() {
    var _this10 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let sharedPrefs = _this10.opts.sharedPreferences;

      _logger.default.info("Trying to set shared preferences");

      let name = sharedPrefs.name;

      if (_lodash.default.isUndefined(name)) {
        _logger.default.warn(`Skipping setting Shared preferences, name is undefined: ${JSON.stringify(sharedPrefs)}`);

        return false;
      }

      let remotePath = `/data/data/${_this10.opts.appPackage}/shared_prefs`;
      let remoteFile = `${remotePath}/${name}.xml`;
      let localPath = `/tmp/${name}.xml`;

      let builder = _this10.getPrefsBuilder();

      builder.build(sharedPrefs.prefs);

      _logger.default.info(`Creating temporary shared preferences: ${localPath}`);

      builder.toFile(localPath);

      _logger.default.info(`Creating shared_prefs remote folder: ${remotePath}`);

      yield _this10.adb.shell(['mkdir', '-p', remotePath]);

      _logger.default.info(`Pushing shared_prefs to ${remoteFile}`);

      yield _this10.adb.push(localPath, remoteFile);

      try {
        _logger.default.info(`Trying to remove shared preferences temporary file`);

        if (yield _appiumSupport.fs.exists(localPath)) {
          yield _appiumSupport.fs.unlink(localPath);
        }
      } catch (e) {
        _logger.default.warn(`Error trying to remove temporary file ${localPath}`);
      }

      return true;
    })();
  }

  getPrefsBuilder() {
    return new _sharedPreferencesBuilder.SharedPrefsBuilder();
  }

  validateDesiredCaps(caps) {
    if (!super.validateDesiredCaps(caps)) {
      return false;
    }

    return _androidHelpers.default.validateDesiredCaps(caps);
  }

  proxyActive(sessionId) {
    super.proxyActive(sessionId);
    return this.jwpProxyActive;
  }

  getProxyAvoidList(sessionId) {
    super.getProxyAvoidList(sessionId);
    return this.jwpProxyAvoid;
  }

  canProxy(sessionId) {
    super.canProxy(sessionId);
    return _lodash.default.isFunction(this.proxyReqRes);
  }

}

exports.AndroidDriver = AndroidDriver;
var _default = AndroidDriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kcml2ZXIuanMiXSwibmFtZXMiOlsiQVBQX0VYVEVOU0lPTiIsIkRFVklDRV9QT1JUIiwiTk9fUFJPWFkiLCJSZWdFeHAiLCJBbmRyb2lkRHJpdmVyIiwiQmFzZURyaXZlciIsImNvbnN0cnVjdG9yIiwib3B0cyIsInNob3VsZFZhbGlkYXRlQ2FwcyIsImxvY2F0b3JTdHJhdGVnaWVzIiwiZGVzaXJlZENhcENvbnN0cmFpbnRzIiwiZGVzaXJlZENvbnN0cmFpbnRzIiwic2Vzc2lvbkNocm9tZWRyaXZlcnMiLCJqd3BQcm94eUFjdGl2ZSIsImp3cFByb3h5QXZvaWQiLCJfIiwiY2xvbmUiLCJzZXR0aW5ncyIsIkRldmljZVNldHRpbmdzIiwiaWdub3JlVW5pbXBvcnRhbnRWaWV3cyIsIm9uU2V0dGluZ3NVcGRhdGUiLCJiaW5kIiwiY2hyb21lZHJpdmVyIiwiYXBrU3RyaW5ncyIsImJvb3RzdHJhcFBvcnQiLCJ1bmxvY2tlciIsImhlbHBlcnMiLCJ0b1BhaXJzIiwiY29tbWFuZHMiLCJjbWQiLCJmbiIsInByb3RvdHlwZSIsImNyZWF0ZVNlc3Npb24iLCJhcmdzIiwic2Vzc2lvbklkIiwiY2FwcyIsInNlcnZlckRldGFpbHMiLCJwbGF0Zm9ybSIsIndlYlN0b3JhZ2VFbmFibGVkIiwidGFrZXNTY3JlZW5zaG90IiwiamF2YXNjcmlwdEVuYWJsZWQiLCJkYXRhYmFzZUVuYWJsZWQiLCJuZXR3b3JrQ29ubmVjdGlvbkVuYWJsZWQiLCJsb2NhdGlvbkNvbnRleHRFbmFibGVkIiwid2FybmluZ3MiLCJkZXNpcmVkIiwiT2JqZWN0IiwiYXNzaWduIiwiZGVmYXVsdE9wdHMiLCJhY3Rpb24iLCJjYXRlZ29yeSIsImZsYWdzIiwiZGlzYWJsZUFuZHJvaWRXYXRjaGVycyIsInRtcERpciIsInRlbXBEaXIiLCJzdGF0aWNEaXIiLCJmdWxsUmVzZXQiLCJhdXRvTGF1bmNoIiwiYWRiUG9ydCIsIkRFRkFVTFRfQURCX1BPUlQiLCJhbmRyb2lkSW5zdGFsbFRpbWVvdXQiLCJkZWZhdWx0cyIsImphdmFWZXJzaW9uIiwiZ2V0SmF2YVZlcnNpb24iLCJ1c2VVbmxvY2tIZWxwZXJBcHAiLCJpc1VuZGVmaW5lZCIsInVubG9ja1R5cGUiLCJub1Jlc2V0IiwiZmFzdFJlc2V0Iiwic2tpcFVuaW5zdGFsbCIsImN1ckNvbnRleHQiLCJkZWZhdWx0Q29udGV4dE5hbWUiLCJpc0Nocm9tZVNlc3Npb24iLCJsb2ciLCJpbmZvIiwiZ2V0Q2hyb21lUGtnIiwiYnJvd3Nlck5hbWUiLCJwa2ciLCJhY3Rpdml0eSIsImFwcFBhY2thZ2UiLCJhcHBBY3Rpdml0eSIsIm5hdGl2ZVdlYlNjcmVlbnNob3QiLCJwdXNoIiwicmVib290Iiwic2V0QXZkRnJvbUNhcGFiaWxpdGllcyIsImdldERldmljZUluZm9Gcm9tQ2FwcyIsInVkaWQiLCJlbVBvcnQiLCJhZGIiLCJjcmVhdGVBREIiLCJzdXBwcmVzc0tpbGxTZXJ2ZXIiLCJyZW1vdGVBZGJIb3N0IiwiY2xlYXJEZXZpY2VMb2dzT25TdGFydCIsImFkYkV4ZWNUaW1lb3V0IiwiZ2V0QXBpTGV2ZWwiLCJ3YXJuIiwiaXNQYWNrYWdlT3JCdW5kbGUiLCJhcHAiLCJjb25maWd1cmVBcHAiLCJhcHBJc1RlbXAiLCJjaGVja0FwcFByZXNlbnQiLCJhcHBPbkRldmljZSIsImNoZWNrUGFja2FnZVByZXNlbnQiLCJ1dGlsIiwiaGFzVmFsdWUiLCJuZXR3b3JrU3BlZWQiLCJpc0VtdWxhdG9yIiwiZW5zdXJlTmV0d29ya1NwZWVkIiwiZ3BzRW5hYmxlZCIsInRvZ2dsZUdQU0xvY2F0aW9uUHJvdmlkZXIiLCJzdGFydEFuZHJvaWRTZXNzaW9uIiwiZSIsImRlbGV0ZVNlc3Npb24iLCJpZ24iLCJhdmQiLCJ0ZXN0IiwiZGV2aWNlTmFtZSIsImVycm9yQW5kVGhyb3ciLCJwbGF0Zm9ybVZlcnNpb24iLCJhdmREZXZpY2UiLCJyZXBsYWNlIiwiaXNDaHJvbWVCcm93c2VyIiwia2V5IiwidmFsdWUiLCJzZXRDb21wcmVzc2VkTGF5b3V0SGllcmFyY2h5IiwiZGVmYXVsdElNRSIsImluaXREZXZpY2UiLCJjdXJEZXZpY2VJZCIsImRldmljZVVESUQiLCJnZXRQbGF0Zm9ybVZlcnNpb24iLCJkZXZpY2VTY3JlZW5TaXplIiwiZ2V0U2NyZWVuU2l6ZSIsImRldmljZU1vZGVsIiwiZ2V0TW9kZWwiLCJkZXZpY2VNYW51ZmFjdHVyZXIiLCJnZXRNYW51ZmFjdHVyZXIiLCJpbml0QVVUIiwiZGlzYWJsZVdpbmRvd0FuaW1hdGlvbiIsImlzQW5pbWF0aW9uT24iLCJzZXRIaWRkZW5BcGlQb2xpY3kiLCJzZXRBbmltYXRpb25TdGF0ZSIsIl93YXNXaW5kb3dBbmltYXRpb25EaXNhYmxlZCIsImJvb3RzdHJhcCIsIndlYnNvY2tldCIsInN0YXJ0IiwiYWNjZXB0U3NsQ2VydHMiLCJvblVuZXhwZWN0ZWRTaHV0ZG93biIsImNhdGNoIiwiZXJyIiwiaWdub3JlVW5leHBlY3RlZFNodXRkb3duIiwic3RhcnRVbmV4cGVjdGVkU2h1dGRvd24iLCJza2lwVW5sb2NrIiwidW5sb2NrIiwidXBkYXRlIiwic3RhcnRDaHJvbWVTZXNzaW9uIiwic3RhcnRBVVQiLCJvcmllbnRhdGlvbiIsImRlYnVnIiwic2V0T3JpZW50YXRpb24iLCJpbml0QXV0b1dlYnZpZXciLCJhdXRvV2VidmlldyIsInZpZXdOYW1lIiwiZGVmYXVsdFdlYnZpZXdOYW1lIiwidGltZW91dCIsImF1dG9XZWJ2aWV3VGltZW91dCIsInNldENvbnRleHQiLCJsYXVuY2hJbmZvIiwiZ2V0TGF1bmNoSW5mbyIsIm90aGVyQXBwcyIsInBhcnNlQXJyYXkiLCJtZXNzYWdlIiwiQiIsImFsbCIsIm1hcCIsImluc3RhbGxPdGhlckFwa3MiLCJyZXNldEFwcCIsInVuaW5zdGFsbEFwayIsImluc3RhbGxBcGsiLCJhcGtTdHJpbmdzRm9yTGFuZ3VhZ2UiLCJwdXNoU3RyaW5ncyIsImxhbmd1YWdlIiwic2hhcmVkUHJlZmVyZW5jZXMiLCJzZXRTaGFyZWRQcmVmZXJlbmNlcyIsImZzIiwiZXhpc3RzIiwic2hlbGwiLCJjb21wcmVzcyIsInNlbmRBY3Rpb24iLCJjb21wcmVzc0xheW91dCIsInJlbW92ZUFsbFNlc3Npb25XZWJTb2NrZXRIYW5kbGVycyIsInNlcnZlciIsInN0b3BDaHJvbWVkcml2ZXJQcm94aWVzIiwidW5pY29kZUtleWJvYXJkIiwicmVzZXRLZXlib2FyZCIsInNldElNRSIsImZvcmNlU3RvcCIsImdvVG9Ib21lIiwic2h1dGRvd24iLCJzdG9wTG9nY2F0Iiwic2V0RGVmYXVsdEhpZGRlbkFwaVBvbGljeSIsImF2ZE5hbWUiLCJraWxsRW11bGF0b3IiLCJjbGVhclN5c3RlbUZpbGVzIiwicmltcmFmIiwic2hhcmVkUHJlZnMiLCJuYW1lIiwiSlNPTiIsInN0cmluZ2lmeSIsInJlbW90ZVBhdGgiLCJyZW1vdGVGaWxlIiwibG9jYWxQYXRoIiwiYnVpbGRlciIsImdldFByZWZzQnVpbGRlciIsImJ1aWxkIiwicHJlZnMiLCJ0b0ZpbGUiLCJ1bmxpbmsiLCJTaGFyZWRQcmVmc0J1aWxkZXIiLCJ2YWxpZGF0ZURlc2lyZWRDYXBzIiwicHJveHlBY3RpdmUiLCJnZXRQcm94eUF2b2lkTGlzdCIsImNhblByb3h5IiwiaXNGdW5jdGlvbiIsInByb3h5UmVxUmVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsYUFBYSxHQUFHLE1BQXRCO0FBQ0EsTUFBTUMsV0FBVyxHQUFHLElBQXBCO0FBSUEsTUFBTUMsUUFBUSxHQUFHLENBQ2YsQ0FBQyxNQUFELEVBQVMsSUFBSUMsTUFBSixDQUFXLHlCQUFYLENBQVQsQ0FEZSxFQUVmLENBQUMsS0FBRCxFQUFRLElBQUlBLE1BQUosQ0FBVyx5QkFBWCxDQUFSLENBRmUsRUFHZixDQUFDLE1BQUQsRUFBUyxJQUFJQSxNQUFKLENBQVcsd0JBQVgsQ0FBVCxDQUhlLEVBSWYsQ0FBQyxLQUFELEVBQVEsSUFBSUEsTUFBSixDQUFXLHdCQUFYLENB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QixDQUFFdkwsSUFBRixFQUFRO0FBQ3pCLFFBQUksQ0FBQyxNQUFNdUwsbUJBQU4sQ0FBMEJ2TCxJQUExQixDQUFMLEVBQXNDO0FBQ3BDLGFBQU8sS0FBUDtBQUNEOztBQUNELFdBQU9ULHdCQUFRZ00sbUJBQVIsQ0FBNEJ2TCxJQUE1QixDQUFQO0FBQ0Q7O0FBRUR3TCxFQUFBQSxXQUFXLENBQUV6TCxTQUFGLEVBQWE7QUFDdEIsVUFBTXlMLFdBQU4sQ0FBa0J6TCxTQUFsQjtBQUVBLFdBQU8sS0FBS3JCLGNBQVo7QUFDRDs7QUFFRCtNLEVBQUFBLGlCQUFpQixDQUFFMUwsU0FBRixFQUFhO0FBQzVCLFVBQU0wTCxpQkFBTixDQUF3QjFMLFNBQXhCO0FBRUEsV0FBTyxLQUFLcEIsYUFBWjtBQUNEOztBQUVEK00sRUFBQUEsUUFBUSxDQUFFM0wsU0FBRixFQUFhO0FBQ25CLFVBQU0yTCxRQUFOLENBQWUzTCxTQUFmO0FBR0EsV0FBT25CLGdCQUFFK00sVUFBRixDQUFhLEtBQUtDLFdBQWxCLENBQVA7QUFDRDs7QUE5ZG9DOzs7ZUFrZXhCM04sYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VEcml2ZXIsIERldmljZVNldHRpbmdzIH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCBkZXNpcmVkQ29uc3RyYWludHMgZnJvbSAnLi9kZXNpcmVkLWNhcHMnO1xuaW1wb3J0IGNvbW1hbmRzIGZyb20gJy4vY29tbWFuZHMvaW5kZXgnO1xuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi9hbmRyb2lkLWhlbHBlcnMnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgREVGQVVMVF9BREJfUE9SVCB9IGZyb20gJ2FwcGl1bS1hZGInO1xuaW1wb3J0IHsgZnMsIHRlbXBEaXIsIHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgU2hhcmVkUHJlZnNCdWlsZGVyIH0gZnJvbSAnc2hhcmVkLXByZWZlcmVuY2VzLWJ1aWxkZXInO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuXG5jb25zdCBBUFBfRVhURU5TSU9OID0gJy5hcGsnO1xuY29uc3QgREVWSUNFX1BPUlQgPSA0NzI0O1xuXG4vLyBUaGlzIGlzIGEgc2V0IG9mIG1ldGhvZHMgYW5kIHBhdGhzIHRoYXQgd2UgbmV2ZXIgd2FudCB0byBwcm94eSB0b1xuLy8gQ2hyb21lZHJpdmVyXG5jb25zdCBOT19QUk9YWSA9IFtcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2NvbnRleHQnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2NvbnRleHQnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0nKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FwcGl1bScpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL3RvdWNoL3BlcmZvcm0nKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy90b3VjaC9tdWx0aS9wZXJmb3JtJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvb3JpZW50YXRpb24nKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL29yaWVudGF0aW9uJyldLFxuXTtcblxuY2xhc3MgQW5kcm9pZERyaXZlciBleHRlbmRzIEJhc2VEcml2ZXIge1xuICBjb25zdHJ1Y3RvciAob3B0cyA9IHt9LCBzaG91bGRWYWxpZGF0ZUNhcHMgPSB0cnVlKSB7XG4gICAgc3VwZXIob3B0cywgc2hvdWxkVmFsaWRhdGVDYXBzKTtcblxuICAgIHRoaXMubG9jYXRvclN0cmF0ZWdpZXMgPSBbXG4gICAgICAneHBhdGgnLFxuICAgICAgJ2lkJyxcbiAgICAgICdjbGFzcyBuYW1lJyxcbiAgICAgICdhY2Nlc3NpYmlsaXR5IGlkJyxcbiAgICAgICctYW5kcm9pZCB1aWF1dG9tYXRvcidcbiAgICBdO1xuICAgIHRoaXMuZGVzaXJlZENhcENvbnN0cmFpbnRzID0gZGVzaXJlZENvbnN0cmFpbnRzO1xuICAgIHRoaXMuc2Vzc2lvbkNocm9tZWRyaXZlcnMgPSB7fTtcbiAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5qd3BQcm94eUF2b2lkID0gXy5jbG9uZShOT19QUk9YWSk7XG4gICAgdGhpcy5zZXR0aW5ncyA9IG5ldyBEZXZpY2VTZXR0aW5ncyh7aWdub3JlVW5pbXBvcnRhbnRWaWV3czogZmFsc2V9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNldHRpbmdzVXBkYXRlLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY2hyb21lZHJpdmVyID0gbnVsbDtcbiAgICB0aGlzLmFwa1N0cmluZ3MgPSB7fTtcbiAgICB0aGlzLmJvb3RzdHJhcFBvcnQgPSBvcHRzLmJvb3RzdHJhcFBvcnQgfHwgREVWSUNFX1BPUlQ7XG4gICAgdGhpcy51bmxvY2tlciA9IGhlbHBlcnMudW5sb2NrZXI7XG5cbiAgICBmb3IgKGxldCBbY21kLCBmbl0gb2YgXy50b1BhaXJzKGNvbW1hbmRzKSkge1xuICAgICAgQW5kcm9pZERyaXZlci5wcm90b3R5cGVbY21kXSA9IGZuO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVNlc3Npb24gKC4uLmFyZ3MpIHtcbiAgICAvLyB0aGUgd2hvbGUgY3JlYXRlU2Vzc2lvbiBmbG93IGlzIHN1cnJvdW5kZWQgaW4gYSB0cnktY2F0Y2ggc3RhdGVtZW50XG4gICAgLy8gaWYgY3JlYXRpbmcgYSBzZXNzaW9uIGZhaWxzIGF0IGFueSBwb2ludCwgd2UgdGVhcmRvd24gZXZlcnl0aGluZyB3ZVxuICAgIC8vIHNldCB1cCBiZWZvcmUgdGhyb3dpbmcgdGhlIGVycm9yLlxuICAgIHRyeSB7XG4gICAgICBsZXQgW3Nlc3Npb25JZCwgY2Fwc10gPSBhd2FpdCBzdXBlci5jcmVhdGVTZXNzaW9uKC4uLmFyZ3MpO1xuXG4gICAgICBsZXQgc2VydmVyRGV0YWlscyA9IHtcbiAgICAgICAgcGxhdGZvcm06ICdMSU5VWCcsXG4gICAgICAgIHdlYlN0b3JhZ2VFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgdGFrZXNTY3JlZW5zaG90OiB0cnVlLFxuICAgICAgICBqYXZhc2NyaXB0RW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZGF0YWJhc2VFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgbmV0d29ya0Nvbm5lY3Rpb25FbmFibGVkOiB0cnVlLFxuICAgICAgICBsb2NhdGlvbkNvbnRleHRFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgd2FybmluZ3M6IHt9LFxuICAgICAgICBkZXNpcmVkOiB0aGlzLmNhcHNcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuY2FwcyA9IE9iamVjdC5hc3NpZ24oc2VydmVyRGV0YWlscywgdGhpcy5jYXBzKTtcblxuICAgICAgLy8gYXNzaWduaW5nIGRlZmF1bHRzXG4gICAgICBsZXQgZGVmYXVsdE9wdHMgPSB7XG4gICAgICAgIGFjdGlvbjogXCJhbmRyb2lkLmludGVudC5hY3Rpb24uTUFJTlwiLFxuICAgICAgICBjYXRlZ29yeTogXCJhbmRyb2lkLmludGVudC5jYXRlZ29yeS5MQVVOQ0hFUlwiLFxuICAgICAgICBmbGFnczogXCIweDEwMjAwMDAwXCIsXG4gICAgICAgIGRpc2FibGVBbmRyb2lkV2F0Y2hlcnM6IGZhbHNlLFxuICAgICAgICB0bXBEaXI6IGF3YWl0IHRlbXBEaXIuc3RhdGljRGlyKCksXG4gICAgICAgIGZ1bGxSZXNldDogZmFsc2UsXG4gICAgICAgIGF1dG9MYXVuY2g6IHRydWUsXG4gICAgICAgIGFkYlBvcnQ6IERFRkFVTFRfQURCX1BPUlQsXG4gICAgICAgIGFuZHJvaWRJbnN0YWxsVGltZW91dDogOTAwMDAsXG4gICAgICB9O1xuICAgICAgXy5kZWZhdWx0cyh0aGlzLm9wdHMsIGRlZmF1bHRPcHRzKTtcbiAgICAgIGlmICghdGhpcy5vcHRzLmphdmFWZXJzaW9uKSB7XG4gICAgICAgIHRoaXMub3B0cy5qYXZhVmVyc2lvbiA9IGF3YWl0IGhlbHBlcnMuZ2V0SmF2YVZlcnNpb24oKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXNlVW5sb2NrSGVscGVyQXBwID0gXy5pc1VuZGVmaW5lZCh0aGlzLmNhcHMudW5sb2NrVHlwZSk7XG5cbiAgICAgIC8vIG5vdCB1c2VyIHZpc2libGUgdmlhIGNhcHNcbiAgICAgIGlmICh0aGlzLm9wdHMubm9SZXNldCA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLm9wdHMuZnVsbFJlc2V0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRzLmZ1bGxSZXNldCA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLm9wdHMubm9SZXNldCA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5vcHRzLmZhc3RSZXNldCA9ICF0aGlzLm9wdHMuZnVsbFJlc2V0ICYmICF0aGlzLm9wdHMubm9SZXNldDtcbiAgICAgIHRoaXMub3B0cy5za2lwVW5pbnN0YWxsID0gdGhpcy5vcHRzLmZhc3RSZXNldCB8fCB0aGlzLm9wdHMubm9SZXNldDtcblxuICAgICAgdGhpcy5jdXJDb250ZXh0ID0gdGhpcy5kZWZhdWx0Q29udGV4dE5hbWUoKTtcblxuICAgICAgaWYgKHRoaXMuaXNDaHJvbWVTZXNzaW9uKSB7XG4gICAgICAgIGxvZy5pbmZvKFwiV2UncmUgZ29pbmcgdG8gcnVuIGEgQ2hyb21lLWJhc2VkIHNlc3Npb25cIik7XG4gICAgICAgIGxldCB7cGtnLCBhY3Rpdml0eX0gPSBoZWxwZXJzLmdldENocm9tZVBrZyh0aGlzLm9wdHMuYnJvd3Nlck5hbWUpO1xuICAgICAgICB0aGlzLm9wdHMuYXBwUGFja2FnZSA9IHBrZztcbiAgICAgICAgdGhpcy5vcHRzLmFwcEFjdGl2aXR5ID0gYWN0aXZpdHk7XG4gICAgICAgIGxvZy5pbmZvKGBDaHJvbWUtdHlwZSBwYWNrYWdlIGFuZCBhY3Rpdml0eSBhcmUgJHtwa2d9IGFuZCAke2FjdGl2aXR5fWApO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRzLm5hdGl2ZVdlYlNjcmVlbnNob3QpIHtcbiAgICAgICAgdGhpcy5qd3BQcm94eUF2b2lkLnB1c2goWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvc2NyZWVuc2hvdCcpXSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdHMucmVib290KSB7XG4gICAgICAgIHRoaXMuc2V0QXZkRnJvbUNhcGFiaWxpdGllcyhjYXBzKTtcbiAgICAgIH1cblxuICAgICAgLy8gZ2V0IGRldmljZSB1ZGlkIGZvciB0aGlzIHNlc3Npb25cbiAgICAgIGxldCB7dWRpZCwgZW1Qb3J0fSA9IGF3YWl0IGhlbHBlcnMuZ2V0RGV2aWNlSW5mb0Zyb21DYXBzKHRoaXMub3B0cyk7XG4gICAgICB0aGlzLm9wdHMudWRpZCA9IHVkaWQ7XG4gICAgICB0aGlzLm9wdHMuZW1Qb3J0ID0gZW1Qb3J0O1xuXG4gICAgICAvLyBzZXQgdXAgYW4gaW5zdGFuY2Ugb2YgQURCXG4gICAgICB0aGlzLmFkYiA9IGF3YWl0IGhlbHBlcnMuY3JlYXRlQURCKHtcbiAgICAgICAgamF2YVZlcnNpb246IHRoaXMub3B0cy5qYXZhVmVyc2lvbixcbiAgICAgICAgdWRpZDogdGhpcy5vcHRzLnVkaWQsXG4gICAgICAgIGVtUG9ydDogdGhpcy5vcHRzLmVtUG9ydCxcbiAgICAgICAgYWRiUG9ydDogdGhpcy5vcHRzLmFkYlBvcnQsXG4gICAgICAgIHN1cHByZXNzS2lsbFNlcnZlcjogdGhpcy5vcHRzLnN1cHByZXNzS2lsbFNlcnZlcixcbiAgICAgICAgcmVtb3RlQWRiSG9zdDogdGhpcy5vcHRzLnJlbW90ZUFkYkhvc3QsXG4gICAgICAgIGNsZWFyRGV2aWNlTG9nc09uU3RhcnQ6IHRoaXMub3B0cy5jbGVhckRldmljZUxvZ3NPblN0YXJ0LFxuICAgICAgICBhZGJFeGVjVGltZW91dDogdGhpcy5vcHRzLmFkYkV4ZWNUaW1lb3V0LFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChhd2FpdCB0aGlzLmFkYi5nZXRBcGlMZXZlbCgpID49IDIzKSB7XG4gICAgICAgIGxvZy53YXJuKFwiQ29uc2lkZXIgc2V0dGluZyAnYXV0b21hdGlvbk5hbWUnIGNhcGFiaWxpdHkgdG8gXCIgK1xuICAgICAgICAgIFwiJ3VpYXV0b21hdG9yMicgb24gQW5kcm9pZCA+PSA2LCBzaW5jZSBVSUF1dG9tYXRvciBmcmFtZXdvcmsgXCIgK1xuICAgICAgICAgIFwiaXMgbm90IG1haW50YWluZWQgYW55bW9yZSBieSB0aGUgT1MgdmVuZG9yLlwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuaGVscGVycy5pc1BhY2thZ2VPckJ1bmRsZSh0aGlzLm9wdHMuYXBwKSkge1xuICAgICAgICAvLyB1c2VyIHByb3ZpZGVkIHBhY2thZ2UgaW5zdGVhZCBvZiBhcHAgZm9yICdhcHAnIGNhcGFiaWxpdHksIG1hc3NhZ2Ugb3B0aW9uc1xuICAgICAgICB0aGlzLm9wdHMuYXBwUGFja2FnZSA9IHRoaXMub3B0cy5hcHA7XG4gICAgICAgIHRoaXMub3B0cy5hcHAgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRzLmFwcCkge1xuICAgICAgICAvLyBmaW5kIGFuZCBjb3B5LCBvciBkb3dubG9hZCBhbmQgdW56aXAgYW4gYXBwIHVybCBvciBwYXRoXG4gICAgICAgIHRoaXMub3B0cy5hcHAgPSBhd2FpdCB0aGlzLmhlbHBlcnMuY29uZmlndXJlQXBwKHRoaXMub3B0cy5hcHAsIEFQUF9FWFRFTlNJT04pO1xuICAgICAgICB0aGlzLm9wdHMuYXBwSXNUZW1wID0gY2Fwcy5hcHAgIT09IHRoaXMub3B0cy5hcHA7IC8vIGRpZCB3ZSBtYWtlIGEgdGVtcG9yYXJ5IGNvcHk/XG4gICAgICAgIGF3YWl0IHRoaXMuY2hlY2tBcHBQcmVzZW50KCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuYXBwT25EZXZpY2UpIHtcbiAgICAgICAgLy8gdGhlIGFwcCBpc24ndCBhbiBhY3R1YWwgYXBwIGZpbGUgYnV0IHJhdGhlciBzb21ldGhpbmcgd2Ugd2FudCB0b1xuICAgICAgICAvLyBhc3N1bWUgaXMgb24gdGhlIGRldmljZSBhbmQganVzdCBsYXVuY2ggdmlhIHRoZSBhcHBQYWNrYWdlXG4gICAgICAgIGxvZy5pbmZvKGBBcHAgZmlsZSB3YXMgbm90IGxpc3RlZCwgaW5zdGVhZCB3ZSdyZSBnb2luZyB0byBydW4gYCArXG4gICAgICAgICAgICAgICAgIGAke3RoaXMub3B0cy5hcHBQYWNrYWdlfSBkaXJlY3RseSBvbiB0aGUgZGV2aWNlYCk7XG4gICAgICAgIGF3YWl0IHRoaXMuY2hlY2tQYWNrYWdlUHJlc2VudCgpO1xuICAgICAgfVxuXG4gICAgICAvLyBTb21lIGNsb3VkIHNlcnZpY2VzIHVzaW5nIGFwcGl1bSBsYXVuY2ggdGhlIGF2ZCB0aGVtc2VsdmVzLCBzbyB3ZSBlbnN1cmUgbmV0c3BlZWRcbiAgICAgIC8vIGlzIHNldCBmb3IgZW11bGF0b3JzIGJ5IGNhbGxpbmcgYWRiLm5ldHdvcmtTcGVlZCBiZWZvcmUgcnVubmluZyB0aGUgYXBwXG4gICAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMubmV0d29ya1NwZWVkKSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNFbXVsYXRvcigpKSB7XG4gICAgICAgICAgbG9nLndhcm4oXCJTb3JyeSwgbmV0d29ya1NwZWVkIGNhcGFiaWxpdHkgaXMgb25seSBhdmFpbGFibGUgZm9yIGVtdWxhdG9yc1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgbmV0d29ya1NwZWVkID0gaGVscGVycy5lbnN1cmVOZXR3b3JrU3BlZWQodGhpcy5hZGIsIHRoaXMub3B0cy5uZXR3b3JrU3BlZWQpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRiLm5ldHdvcmtTcGVlZChuZXR3b3JrU3BlZWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIHRvIGVuYWJsZS9kaXNhYmxlIGdwcyBiZWZvcmUgcnVubmluZyB0aGUgYXBwbGljYXRpb25cbiAgICAgIGlmICh1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy5ncHNFbmFibGVkKSkge1xuICAgICAgICBpZiAodGhpcy5pc0VtdWxhdG9yKCkpIHtcbiAgICAgICAgICBsb2cuaW5mbyhgVHJ5aW5nIHRvICR7dGhpcy5vcHRzLmdwc0VuYWJsZWQgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJ9IGdwcyBsb2NhdGlvbiBwcm92aWRlcmApO1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRiLnRvZ2dsZUdQU0xvY2F0aW9uUHJvdmlkZXIodGhpcy5vcHRzLmdwc0VuYWJsZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy53YXJuKCdTb3JyeSEgZ3BzRW5hYmxlZCBjYXBhYmlsaXR5IGlzIG9ubHkgYXZhaWxhYmxlIGZvciBlbXVsYXRvcnMnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0QW5kcm9pZFNlc3Npb24odGhpcy5vcHRzKTtcbiAgICAgIHJldHVybiBbc2Vzc2lvbklkLCB0aGlzLmNhcHNdO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIGlnbm9yaW5nIGRlbGV0ZSBzZXNzaW9uIGV4Y2VwdGlvbiBpZiBhbnkgYW5kIHRocm93IHRoZSByZWFsIGVycm9yXG4gICAgICAvLyB0aGF0IGhhcHBlbmVkIHdoaWxlIGNyZWF0aW5nIHRoZSBzZXNzaW9uLlxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVTZXNzaW9uKCk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfVxuXG4gIGlzRW11bGF0b3IgKCkge1xuICAgIHJldHVybiAhISh0aGlzLm9wdHMuYXZkIHx8IC9lbXVsYXRvci8udGVzdCh0aGlzLm9wdHMudWRpZCkpO1xuICB9XG5cbiAgc2V0QXZkRnJvbUNhcGFiaWxpdGllcyAoY2Fwcykge1xuICAgIGlmICh0aGlzLm9wdHMuYXZkKSB7XG4gICAgICBsb2cuaW5mbygnYXZkIG5hbWUgZGVmaW5lZCwgaWdub3JpbmcgZGV2aWNlIG5hbWUgYW5kIHBsYXRmb3JtIHZlcnNpb24nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFjYXBzLmRldmljZU5hbWUpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coJ2F2ZCBvciBkZXZpY2VOYW1lIHNob3VsZCBiZSBzcGVjaWZpZWQgd2hlbiByZWJvb3Qgb3B0aW9uIGlzIGVuYWJsZXMnKTtcbiAgICAgIH1cbiAgICAgIGlmICghY2Fwcy5wbGF0Zm9ybVZlcnNpb24pIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coJ2F2ZCBvciBwbGF0Zm9ybVZlcnNpb24gc2hvdWxkIGJlIHNwZWNpZmllZCB3aGVuIHJlYm9vdCBvcHRpb24gaXMgZW5hYmxlZCcpO1xuICAgICAgfVxuICAgICAgbGV0IGF2ZERldmljZSA9IGNhcHMuZGV2aWNlTmFtZS5yZXBsYWNlKC9bXmEtekEtWjAtOV8uXS9nLCBcIi1cIik7XG4gICAgICB0aGlzLm9wdHMuYXZkID0gYCR7YXZkRGV2aWNlfV9fJHtjYXBzLnBsYXRmb3JtVmVyc2lvbn1gO1xuICAgIH1cbiAgfVxuXG4gIGdldCBhcHBPbkRldmljZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVscGVycy5pc1BhY2thZ2VPckJ1bmRsZSh0aGlzLm9wdHMuYXBwKSB8fCAoIXRoaXMub3B0cy5hcHAgJiZcbiAgICAgICAgICAgdGhpcy5oZWxwZXJzLmlzUGFja2FnZU9yQnVuZGxlKHRoaXMub3B0cy5hcHBQYWNrYWdlKSk7XG4gIH1cblxuICBnZXQgaXNDaHJvbWVTZXNzaW9uICgpIHtcbiAgICByZXR1cm4gaGVscGVycy5pc0Nocm9tZUJyb3dzZXIodGhpcy5vcHRzLmJyb3dzZXJOYW1lKTtcbiAgfVxuXG4gIGFzeW5jIG9uU2V0dGluZ3NVcGRhdGUgKGtleSwgdmFsdWUpIHtcbiAgICBpZiAoa2V5ID09PSBcImlnbm9yZVVuaW1wb3J0YW50Vmlld3NcIikge1xuICAgICAgYXdhaXQgdGhpcy5zZXRDb21wcmVzc2VkTGF5b3V0SGllcmFyY2h5KHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzdGFydEFuZHJvaWRTZXNzaW9uICgpIHtcbiAgICBsb2cuaW5mbyhgU3RhcnRpbmcgQW5kcm9pZCBzZXNzaW9uYCk7XG4gICAgLy8gc2V0IHVwIHRoZSBkZXZpY2UgdG8gcnVuIG9uIChyZWFsIG9yIGVtdWxhdG9yLCBldGMpXG4gICAgdGhpcy5kZWZhdWx0SU1FID0gYXdhaXQgaGVscGVycy5pbml0RGV2aWNlKHRoaXMuYWRiLCB0aGlzLm9wdHMpO1xuXG4gICAgLy8gc2V0IGFjdHVhbCBkZXZpY2UgbmFtZSwgdWRpZCwgcGxhdGZvcm0gdmVyc2lvbiwgc2NyZWVuIHNpemUsIG1vZGVsIGFuZCBtYW51ZmFjdHVyZXIgZGV0YWlscy5cbiAgICB0aGlzLmNhcHMuZGV2aWNlTmFtZSA9IHRoaXMuYWRiLmN1ckRldmljZUlkO1xuICAgIHRoaXMuY2Fwcy5kZXZpY2VVRElEID0gdGhpcy5vcHRzLnVkaWQ7XG4gICAgdGhpcy5jYXBzLnBsYXRmb3JtVmVyc2lvbiA9IGF3YWl0IHRoaXMuYWRiLmdldFBsYXRmb3JtVmVyc2lvbigpO1xuICAgIHRoaXMuY2Fwcy5kZXZpY2VTY3JlZW5TaXplID0gYXdhaXQgdGhpcy5hZGIuZ2V0U2NyZWVuU2l6ZSgpO1xuICAgIHRoaXMuY2Fwcy5kZXZpY2VNb2RlbCA9IGF3YWl0IHRoaXMuYWRiLmdldE1vZGVsKCk7XG4gICAgdGhpcy5jYXBzLmRldmljZU1hbnVmYWN0dXJlciA9IGF3YWl0IHRoaXMuYWRiLmdldE1hbnVmYWN0dXJlcigpO1xuXG4gICAgLy8gSWYgdGhlIHVzZXIgc2V0cyBhdXRvTGF1bmNoIHRvIGZhbHNlLCB0aGV5IGFyZSByZXNwb25zaWJsZSBmb3IgaW5pdEFVVCgpIGFuZCBzdGFydEFVVCgpXG4gICAgaWYgKHRoaXMub3B0cy5hdXRvTGF1bmNoKSB7XG4gICAgICAvLyBzZXQgdXAgYXBwIHVuZGVyIHRlc3RcbiAgICAgIGF3YWl0IHRoaXMuaW5pdEFVVCgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMuZGlzYWJsZVdpbmRvd0FuaW1hdGlvbikge1xuICAgICAgaWYgKGF3YWl0IHRoaXMuYWRiLmlzQW5pbWF0aW9uT24oKSkge1xuICAgICAgICBpZiAoYXdhaXQgdGhpcy5hZGIuZ2V0QXBpTGV2ZWwoKSA+PSAyOCkgeyAvLyBBUEkgbGV2ZWwgMjggaXMgQW5kcm9pZCBQXG4gICAgICAgICAgLy8gRG9uJ3QgZm9yZ2V0IHRvIHJlc2V0IHRoZSByZWxheGluZyBpbiBkZWxldGUgc2Vzc2lvblxuICAgICAgICAgIGxvZy53YXJuKCdSZWxheGluZyBoaWRkZW4gYXBpIHBvbGljeSB0byBtYW5hZ2UgYW5pbWF0aW9uIHNjYWxlJyk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGIuc2V0SGlkZGVuQXBpUG9saWN5KCcxJyk7XG4gICAgICAgIH1cblxuICAgICAgICBsb2cuaW5mbygnRGlzYWJsaW5nIHdpbmRvdyBhbmltYXRpb24gYXMgaXQgaXMgcmVxdWVzdGVkIGJ5IFwiZGlzYWJsZVdpbmRvd0FuaW1hdGlvblwiIGNhcGFiaWxpdHknKTtcbiAgICAgICAgYXdhaXQgdGhpcy5hZGIuc2V0QW5pbWF0aW9uU3RhdGUoZmFsc2UpO1xuICAgICAgICB0aGlzLl93YXNXaW5kb3dBbmltYXRpb25EaXNhYmxlZCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2cuaW5mbygnV2luZG93IGFuaW1hdGlvbiBpcyBhbHJlYWR5IGRpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gc3RhcnQgVWlBdXRvbWF0b3JcbiAgICB0aGlzLmJvb3RzdHJhcCA9IG5ldyBoZWxwZXJzLmJvb3RzdHJhcCh0aGlzLmFkYiwgdGhpcy5ib290c3RyYXBQb3J0LCB0aGlzLm9wdHMud2Vic29ja2V0KTtcbiAgICBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zdGFydCh0aGlzLm9wdHMuYXBwUGFja2FnZSwgdGhpcy5vcHRzLmRpc2FibGVBbmRyb2lkV2F0Y2hlcnMsIHRoaXMub3B0cy5hY2NlcHRTc2xDZXJ0cyk7XG4gICAgLy8gaGFuZGxpbmcgdW5leHBlY3RlZCBzaHV0ZG93blxuICAgIHRoaXMuYm9vdHN0cmFwLm9uVW5leHBlY3RlZFNodXRkb3duLmNhdGNoKGFzeW5jIChlcnIpID0+IHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by1jYWxsYmFja3NcbiAgICAgIGlmICghdGhpcy5ib290c3RyYXAuaWdub3JlVW5leHBlY3RlZFNodXRkb3duKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RhcnRVbmV4cGVjdGVkU2h1dGRvd24oZXJyKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICghdGhpcy5vcHRzLnNraXBVbmxvY2spIHtcbiAgICAgIC8vIExldCdzIHRyeSB0byB1bmxvY2sgdGhlIGRldmljZVxuICAgICAgYXdhaXQgaGVscGVycy51bmxvY2sodGhpcywgdGhpcy5hZGIsIHRoaXMuY2Fwcyk7XG4gICAgfVxuXG4gICAgLy8gU2V0IENvbXByZXNzZWRMYXlvdXRIaWVyYXJjaHkgb24gdGhlIGRldmljZSBiYXNlZCBvbiBjdXJyZW50IHNldHRpbmdzIG9iamVjdFxuICAgIC8vIHRoaXMgaGFzIHRvIGhhcHBlbiBfYWZ0ZXJfIGJvb3RzdHJhcCBpcyBpbml0aWFsaXplZFxuICAgIGlmICh0aGlzLm9wdHMuaWdub3JlVW5pbXBvcnRhbnRWaWV3cykge1xuICAgICAgYXdhaXQgdGhpcy5zZXR0aW5ncy51cGRhdGUoe2lnbm9yZVVuaW1wb3J0YW50Vmlld3M6IHRoaXMub3B0cy5pZ25vcmVVbmltcG9ydGFudFZpZXdzfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNDaHJvbWVTZXNzaW9uKSB7XG4gICAgICAvLyBzdGFydCBhIGNocm9tZWRyaXZlciBzZXNzaW9uIGFuZCBwcm94eSB0byBpdFxuICAgICAgYXdhaXQgdGhpcy5zdGFydENocm9tZVNlc3Npb24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMub3B0cy5hdXRvTGF1bmNoKSB7XG4gICAgICAgIC8vIHN0YXJ0IGFwcFxuICAgICAgICBhd2FpdCB0aGlzLnN0YXJ0QVVUKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLm9yaWVudGF0aW9uKSkge1xuICAgICAgbG9nLmRlYnVnKGBTZXR0aW5nIGluaXRpYWwgb3JpZW50YXRpb24gdG8gJyR7dGhpcy5vcHRzLm9yaWVudGF0aW9ufSdgKTtcbiAgICAgIGF3YWl0IHRoaXMuc2V0T3JpZW50YXRpb24odGhpcy5vcHRzLm9yaWVudGF0aW9uKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLmluaXRBdXRvV2VidmlldygpO1xuICB9XG5cbiAgYXN5bmMgaW5pdEF1dG9XZWJ2aWV3ICgpIHtcbiAgICBpZiAodGhpcy5vcHRzLmF1dG9XZWJ2aWV3KSB7XG4gICAgICBsZXQgdmlld05hbWUgPSB0aGlzLmRlZmF1bHRXZWJ2aWV3TmFtZSgpO1xuICAgICAgbGV0IHRpbWVvdXQgPSAodGhpcy5vcHRzLmF1dG9XZWJ2aWV3VGltZW91dCkgfHwgMjAwMDtcblxuICAgICAgbG9nLmluZm8oYFNldHRpbmcgYXV0byB3ZWJ2aWV3IHRvIGNvbnRleHQgJyR7dmlld05hbWV9JyB3aXRoIHRpbWVvdXQgJHt0aW1lb3V0fW1zYCk7XG5cbiAgICAgIC8vIHRyeSBldmVyeSA1MDBtcyB1bnRpbCB0aW1lb3V0IGlzIG92ZXJcbiAgICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwodGltZW91dCAvIDUwMCwgNTAwLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2V0Q29udGV4dCh2aWV3TmFtZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBpbml0QVVUICgpIHtcbiAgICAvLyBwb3B1bGF0ZSBhcHBQYWNrYWdlLCBhcHBBY3Rpdml0eSwgYXBwV2FpdFBhY2thZ2UsIGFwcFdhaXRBY3Rpdml0eSxcbiAgICAvLyBhbmQgdGhlIGRldmljZSBiZWluZyB1c2VkXG4gICAgLy8gaW4gdGhlIG9wdHMgYW5kIGNhcHMgKHNvIGl0IGdldHMgYmFjayB0byB0aGUgdXNlciBvbiBzZXNzaW9uIGNyZWF0aW9uKVxuICAgIGxldCBsYXVuY2hJbmZvID0gYXdhaXQgaGVscGVycy5nZXRMYXVuY2hJbmZvKHRoaXMuYWRiLCB0aGlzLm9wdHMpO1xuICAgIE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLCBsYXVuY2hJbmZvKTtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMuY2FwcywgbGF1bmNoSW5mbyk7XG5cbiAgICAvLyBJbnN0YWxsIGFueSBcIm90aGVyQXBwc1wiIHRoYXQgd2VyZSBzcGVjaWZpZWQgaW4gY2Fwc1xuICAgIGlmICh0aGlzLm9wdHMub3RoZXJBcHBzKSB7XG4gICAgICBsZXQgb3RoZXJBcHBzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgb3RoZXJBcHBzID0gaGVscGVycy5wYXJzZUFycmF5KHRoaXMub3B0cy5vdGhlckFwcHMpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQ291bGQgbm90IHBhcnNlIFwib3RoZXJBcHBzXCIgY2FwYWJpbGl0eTogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgICBvdGhlckFwcHMgPSBhd2FpdCBCLmFsbChvdGhlckFwcHMubWFwKChhcHApID0+IHRoaXMuaGVscGVycy5jb25maWd1cmVBcHAoYXBwLCBBUFBfRVhURU5TSU9OKSkpO1xuICAgICAgYXdhaXQgaGVscGVycy5pbnN0YWxsT3RoZXJBcGtzKG90aGVyQXBwcywgdGhpcy5hZGIsIHRoaXMub3B0cyk7XG4gICAgfVxuXG4gICAgLy8gaW5zdGFsbCBhcHBcbiAgICBpZiAoIXRoaXMub3B0cy5hcHApIHtcbiAgICAgIGlmICh0aGlzLm9wdHMuZnVsbFJlc2V0KSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KCdGdWxsIHJlc2V0IHJlcXVpcmVzIGFuIGFwcCBjYXBhYmlsaXR5LCB1c2UgZmFzdFJlc2V0IGlmIGFwcCBpcyBub3QgcHJvdmlkZWQnKTtcbiAgICAgIH1cbiAgICAgIGxvZy5kZWJ1ZygnTm8gYXBwIGNhcGFiaWxpdHkuIEFzc3VtaW5nIGl0IGlzIGFscmVhZHkgb24gdGhlIGRldmljZScpO1xuICAgICAgaWYgKHRoaXMub3B0cy5mYXN0UmVzZXQpIHtcbiAgICAgICAgYXdhaXQgaGVscGVycy5yZXNldEFwcCh0aGlzLmFkYiwgdGhpcy5vcHRzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdHMuc2tpcFVuaW5zdGFsbCkge1xuICAgICAgYXdhaXQgdGhpcy5hZGIudW5pbnN0YWxsQXBrKHRoaXMub3B0cy5hcHBQYWNrYWdlKTtcbiAgICB9XG4gICAgYXdhaXQgaGVscGVycy5pbnN0YWxsQXBrKHRoaXMuYWRiLCB0aGlzLm9wdHMpO1xuICAgIGNvbnN0IGFwa1N0cmluZ3NGb3JMYW5ndWFnZSA9IGF3YWl0IGhlbHBlcnMucHVzaFN0cmluZ3ModGhpcy5vcHRzLmxhbmd1YWdlLCB0aGlzLmFkYiwgdGhpcy5vcHRzKTtcbiAgICBpZiAodGhpcy5vcHRzLmxhbmd1YWdlKSB7XG4gICAgICB0aGlzLmFwa1N0cmluZ3NbdGhpcy5vcHRzLmxhbmd1YWdlXSA9IGFwa1N0cmluZ3NGb3JMYW5ndWFnZTtcbiAgICB9XG5cbiAgICAvLyBUaGlzIG11c3QgcnVuIGFmdGVyIGluc3RhbGxpbmcgdGhlIGFwaywgb3RoZXJ3aXNlIGl0IHdvdWxkIGNhdXNlIHRoZVxuICAgIC8vIGluc3RhbGwgdG8gZmFpbC4gQW5kIGJlZm9yZSBydW5uaW5nIHRoZSBhcHAuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHRoaXMub3B0cy5zaGFyZWRQcmVmZXJlbmNlcykpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0U2hhcmVkUHJlZmVyZW5jZXModGhpcy5vcHRzKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjaGVja0FwcFByZXNlbnQgKCkge1xuICAgIGxvZy5kZWJ1ZyhcIkNoZWNraW5nIHdoZXRoZXIgYXBwIGlzIGFjdHVhbGx5IHByZXNlbnRcIik7XG4gICAgaWYgKCEoYXdhaXQgZnMuZXhpc3RzKHRoaXMub3B0cy5hcHApKSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENvdWxkIG5vdCBmaW5kIGFwcCBhcGsgYXQgJHt0aGlzLm9wdHMuYXBwfWApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNoZWNrUGFja2FnZVByZXNlbnQgKCkge1xuICAgIGxvZy5kZWJ1ZyhcIkNoZWNraW5nIHdoZXRoZXIgcGFja2FnZSBpcyBwcmVzZW50IG9uIHRoZSBkZXZpY2VcIik7XG4gICAgaWYgKCEoYXdhaXQgdGhpcy5hZGIuc2hlbGwoWydwbScsICdsaXN0JywgJ3BhY2thZ2VzJywgdGhpcy5vcHRzLmFwcFBhY2thZ2VdKSkpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGBDb3VsZCBub3QgZmluZCBwYWNrYWdlICR7dGhpcy5vcHRzLmFwcFBhY2thZ2V9IG9uIHRoZSBkZXZpY2VgKTtcbiAgICB9XG4gIH1cblxuICAvLyBTZXQgQ29tcHJlc3NlZExheW91dEhpZXJhcmNoeSBvbiB0aGUgZGV2aWNlXG4gIGFzeW5jIHNldENvbXByZXNzZWRMYXlvdXRIaWVyYXJjaHkgKGNvbXByZXNzKSB7XG4gICAgYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbihcImNvbXByZXNzZWRMYXlvdXRIaWVyYXJjaHlcIiwge2NvbXByZXNzTGF5b3V0OiBjb21wcmVzc30pO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlU2Vzc2lvbiAoKSB7XG4gICAgbG9nLmRlYnVnKFwiU2h1dHRpbmcgZG93biBBbmRyb2lkIGRyaXZlclwiKTtcbiAgICBhd2FpdCBoZWxwZXJzLnJlbW92ZUFsbFNlc3Npb25XZWJTb2NrZXRIYW5kbGVycyh0aGlzLnNlcnZlciwgdGhpcy5zZXNzaW9uSWQpO1xuICAgIGF3YWl0IHN1cGVyLmRlbGV0ZVNlc3Npb24oKTtcbiAgICBpZiAodGhpcy5ib290c3RyYXApIHtcbiAgICAgIC8vIGNlcnRhaW4gY2xlYW51cCB3ZSBvbmx5IGNhcmUgdG8gZG8gaWYgdGhlIGJvb3RzdHJhcCB3YXMgZXZlciBydW5cbiAgICAgIGF3YWl0IHRoaXMuc3RvcENocm9tZWRyaXZlclByb3hpZXMoKTtcbiAgICAgIGlmICh0aGlzLm9wdHMudW5pY29kZUtleWJvYXJkICYmIHRoaXMub3B0cy5yZXNldEtleWJvYXJkICYmIHRoaXMuZGVmYXVsdElNRSkge1xuICAgICAgICBsb2cuZGVidWcoYFJlc2V0dGluZyBJTUUgdG8gJHt0aGlzLmRlZmF1bHRJTUV9YCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYWRiLnNldElNRSh0aGlzLmRlZmF1bHRJTUUpO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmlzQ2hyb21lU2Vzc2lvbikge1xuICAgICAgICBhd2FpdCB0aGlzLmFkYi5mb3JjZVN0b3AodGhpcy5vcHRzLmFwcFBhY2thZ2UpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5hZGIuZ29Ub0hvbWUoKTtcbiAgICAgIGlmICh0aGlzLm9wdHMuZnVsbFJlc2V0ICYmICF0aGlzLm9wdHMuc2tpcFVuaW5zdGFsbCAmJiAhdGhpcy5hcHBPbkRldmljZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmFkYi51bmluc3RhbGxBcGsodGhpcy5vcHRzLmFwcFBhY2thZ2UpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5ib290c3RyYXAuc2h1dGRvd24oKTtcbiAgICAgIHRoaXMuYm9vdHN0cmFwID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLmRlYnVnKFwiQ2FsbGVkIGRlbGV0ZVNlc3Npb24gYnV0IGJvb3RzdHJhcCB3YXNuJ3QgYWN0aXZlXCIpO1xuICAgIH1cbiAgICAvLyBzb21lIGNsZWFudXAgd2Ugd2FudCB0byBkbyByZWdhcmRsZXNzLCBpbiBjYXNlIHdlIGFyZSBzaHV0dGluZyBkb3duXG4gICAgLy8gbWlkLXN0YXJ0dXBcbiAgICBhd2FpdCB0aGlzLmFkYi5zdG9wTG9nY2F0KCk7XG4gICAgaWYgKHRoaXMudXNlVW5sb2NrSGVscGVyQXBwKSB7XG4gICAgICBhd2FpdCB0aGlzLmFkYi5mb3JjZVN0b3AoJ2lvLmFwcGl1bS51bmxvY2snKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX3dhc1dpbmRvd0FuaW1hdGlvbkRpc2FibGVkKSB7XG4gICAgICBsb2cuaW5mbygnUmVzdG9yaW5nIHdpbmRvdyBhbmltYXRpb24gc3RhdGUnKTtcbiAgICAgIGF3YWl0IHRoaXMuYWRiLnNldEFuaW1hdGlvblN0YXRlKHRydWUpO1xuXG4gICAgICAvLyBUaGlzIHdhcyBuZWNlc3NhcnkgdG8gY2hhbmdlIGFuaW1hdGlvbiBzY2FsZSBvdmVyIEFuZHJvaWQgUC4gV2UgbXVzdCByZXNldCB0aGUgcG9saWN5IGZvciB0aGUgc2VjdXJpdHkuXG4gICAgICBpZiAoYXdhaXQgdGhpcy5hZGIuZ2V0QXBpTGV2ZWwoKSA+PSAyOCkge1xuICAgICAgICBsb2cuaW5mbygnUmVzdG9yaW5nIGhpZGRlbiBhcGkgcG9saWN5IHRvIHRoZSBkZXZpY2UgZGVmYXVsdCBjb25maWd1cmF0aW9uJyk7XG4gICAgICAgIGF3YWl0IHRoaXMuYWRiLnNldERlZmF1bHRIaWRkZW5BcGlQb2xpY3koKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRzLnJlYm9vdCkge1xuICAgICAgbGV0IGF2ZE5hbWUgPSB0aGlzLm9wdHMuYXZkLnJlcGxhY2UoJ0AnLCAnJyk7XG4gICAgICBsb2cuZGVidWcoYGNsb3NpbmcgZW11bGF0b3IgJyR7YXZkTmFtZX0nYCk7XG4gICAgICBhd2FpdCB0aGlzLmFkYi5raWxsRW11bGF0b3IoYXZkTmFtZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdHMuY2xlYXJTeXN0ZW1GaWxlcykge1xuICAgICAgaWYgKHRoaXMub3B0cy5hcHBJc1RlbXApIHtcbiAgICAgICAgbG9nLmRlYnVnKGBUZW1wb3JhcnkgY29weSBvZiBhcHAgd2FzIG1hZGU6IGRlbGV0aW5nICcke3RoaXMub3B0cy5hcHB9J2ApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGZzLnJpbXJhZih0aGlzLm9wdHMuYXBwKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgbG9nLndhcm4oYFVuYWJsZSB0byBkZWxldGUgdGVtcG9yYXJ5IGFwcDogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmRlYnVnKCdBcHAgd2FzIG5vdCBjb3BpZWQsIHNvIG5vdCBkZWxldGluZycpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2cuZGVidWcoJ05vdCBjbGVhbmluZyBnZW5lcmF0ZWQgZmlsZXMuIEFkZCBgY2xlYXJTeXN0ZW1GaWxlc2AgY2FwYWJpbGl0eSBpZiB3YW50ZWQuJyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2V0U2hhcmVkUHJlZmVyZW5jZXMgKCkge1xuICAgIGxldCBzaGFyZWRQcmVmcyA9IHRoaXMub3B0cy5zaGFyZWRQcmVmZXJlbmNlcztcbiAgICBsb2cuaW5mbyhcIlRyeWluZyB0byBzZXQgc2hhcmVkIHByZWZlcmVuY2VzXCIpO1xuICAgIGxldCBuYW1lID0gc2hhcmVkUHJlZnMubmFtZTtcbiAgICBpZiAoXy5pc1VuZGVmaW5lZChuYW1lKSkge1xuICAgICAgbG9nLndhcm4oYFNraXBwaW5nIHNldHRpbmcgU2hhcmVkIHByZWZlcmVuY2VzLCBuYW1lIGlzIHVuZGVmaW5lZDogJHtKU09OLnN0cmluZ2lmeShzaGFyZWRQcmVmcyl9YCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCByZW1vdGVQYXRoID0gYC9kYXRhL2RhdGEvJHt0aGlzLm9wdHMuYXBwUGFja2FnZX0vc2hhcmVkX3ByZWZzYDtcbiAgICBsZXQgcmVtb3RlRmlsZSA9IGAke3JlbW90ZVBhdGh9LyR7bmFtZX0ueG1sYDtcbiAgICBsZXQgbG9jYWxQYXRoID0gYC90bXAvJHtuYW1lfS54bWxgO1xuICAgIGxldCBidWlsZGVyID0gdGhpcy5nZXRQcmVmc0J1aWxkZXIoKTtcbiAgICBidWlsZGVyLmJ1aWxkKHNoYXJlZFByZWZzLnByZWZzKTtcbiAgICBsb2cuaW5mbyhgQ3JlYXRpbmcgdGVtcG9yYXJ5IHNoYXJlZCBwcmVmZXJlbmNlczogJHtsb2NhbFBhdGh9YCk7XG4gICAgYnVpbGRlci50b0ZpbGUobG9jYWxQYXRoKTtcbiAgICBsb2cuaW5mbyhgQ3JlYXRpbmcgc2hhcmVkX3ByZWZzIHJlbW90ZSBmb2xkZXI6ICR7cmVtb3RlUGF0aH1gKTtcbiAgICBhd2FpdCB0aGlzLmFkYi5zaGVsbChbJ21rZGlyJywgJy1wJywgcmVtb3RlUGF0aF0pO1xuICAgIGxvZy5pbmZvKGBQdXNoaW5nIHNoYXJlZF9wcmVmcyB0byAke3JlbW90ZUZpbGV9YCk7XG4gICAgYXdhaXQgdGhpcy5hZGIucHVzaChsb2NhbFBhdGgsIHJlbW90ZUZpbGUpO1xuICAgIHRyeSB7XG4gICAgICBsb2cuaW5mbyhgVHJ5aW5nIHRvIHJlbW92ZSBzaGFyZWQgcHJlZmVyZW5jZXMgdGVtcG9yYXJ5IGZpbGVgKTtcbiAgICAgIGlmIChhd2FpdCBmcy5leGlzdHMobG9jYWxQYXRoKSkge1xuICAgICAgICBhd2FpdCBmcy51bmxpbmsobG9jYWxQYXRoKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cud2FybihgRXJyb3IgdHJ5aW5nIHRvIHJlbW92ZSB0ZW1wb3JhcnkgZmlsZSAke2xvY2FsUGF0aH1gKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBnZXRQcmVmc0J1aWxkZXIgKCkge1xuICAgIC8qIEFkZCB0aGlzIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgU2hhcmVkUHJlZnNCdWlsZGVyIGluc3RlYWQgb2ZcbiAgICAgKiBkaXJlY3RseSBjcmVhdGluZyB0aGUgb2JqZWN0IG9uIHNldFNoYXJlZFByZWZlcmVuY2VzIGZvciB0ZXN0aW5nIHB1cnBvc2VzXG4gICAgKi9cbiAgICByZXR1cm4gbmV3IFNoYXJlZFByZWZzQnVpbGRlcigpO1xuICB9XG5cbiAgdmFsaWRhdGVEZXNpcmVkQ2FwcyAoY2Fwcykge1xuICAgIGlmICghc3VwZXIudmFsaWRhdGVEZXNpcmVkQ2FwcyhjYXBzKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gaGVscGVycy52YWxpZGF0ZURlc2lyZWRDYXBzKGNhcHMpO1xuICB9XG5cbiAgcHJveHlBY3RpdmUgKHNlc3Npb25JZCkge1xuICAgIHN1cGVyLnByb3h5QWN0aXZlKHNlc3Npb25JZCk7XG5cbiAgICByZXR1cm4gdGhpcy5qd3BQcm94eUFjdGl2ZTtcbiAgfVxuXG4gIGdldFByb3h5QXZvaWRMaXN0IChzZXNzaW9uSWQpIHtcbiAgICBzdXBlci5nZXRQcm94eUF2b2lkTGlzdChzZXNzaW9uSWQpO1xuXG4gICAgcmV0dXJuIHRoaXMuandwUHJveHlBdm9pZDtcbiAgfVxuXG4gIGNhblByb3h5IChzZXNzaW9uSWQpIHtcbiAgICBzdXBlci5jYW5Qcm94eShzZXNzaW9uSWQpO1xuXG4gICAgLy8gdGhpcyB3aWxsIGNoYW5nZSBkZXBlbmRpbmcgb24gQ2hyb21lRHJpdmVyIHN0YXR1c1xuICAgIHJldHVybiBfLmlzRnVuY3Rpb24odGhpcy5wcm94eVJlcVJlcyk7XG4gIH1cbn1cblxuZXhwb3J0IHsgQW5kcm9pZERyaXZlciB9O1xuZXhwb3J0IGRlZmF1bHQgQW5kcm9pZERyaXZlcjtcbiJdLCJmaWxlIjoibGliL2RyaXZlci5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiJ9
